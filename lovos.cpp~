#include <iostream>
#include <conio.h>
#include <string>
#include <iomanip>

#define KSZ 60					// Kepernyo szelessege
#define KM 20					// Kepernyo magassaga
#define JSZ 30					// Jatekter szelessege
#define JM 15					// Jatekter magassaga
#define FUGGOLEGES 179			// - Jatekter függőleges oldala
#define VIZSZINTES 196			// ¦ Jatekter vízszintes oldala
#define BAL_FELSO_SAROK 218		// - Jatekter bal felso sarka
#define JOBB_FELSO_SAROK 191	// ¬ Jatekter jobb felso sarka
#define BAL_ALSO_SAROK 192		// L Jatekter bal also sarka
#define JOBB_ALSO_SAROK 217		// - Jatekter jobb also sarka

//unsigned long long gameTick = 0;

struct tabla
{
	unsigned char tegla[JM][JSZ] = { 32 };
	char legfelsoSor = 0;
	char utolsoSor = 0;
};

char jatekosIranyitasa(bool& valtozas)
{
	unsigned char parancs = '0';
	if (_kbhit()) {
		parancs = _getch();
		if (parancs != 'a' && parancs != 'd' && int(parancs) != 27) parancs = '0';
		valtozas = true;
	}
	return parancs;
}

void agyuElhelyezese(int* agyu, char irany)
{
	if (irany == 'a' && agyu[0] > 0) for (int i = 0; i < 3; i++) agyu[i]--;
	if (irany == 'd' && agyu[2] < JSZ) for (int i = 0; i < 3; i++) agyu[i]++;
}

void kepernyoRajzolasa(tabla& teglak, int* agyu)
{
	system("cls");
	for (int i = 0; i < JM; i++)
	{
		i < 10 ? std::cout << " " << i : std::cout << i;	//debug!
		if (i == 0) std::cout << char(BAL_FELSO_SAROK);
		else if (i == JM - 1) std::cout << char(BAL_ALSO_SAROK);
		else std::cout << char(FUGGOLEGES);
		for (int j = 0; j < JSZ; j++)
		{
			std::cout << char(teglak.tegla[i][j]);
		}
		if (i == 0) std::cout << char(JOBB_FELSO_SAROK);
		else if (i == JM - 1) std::cout << char(JOBB_ALSO_SAROK);
		else std::cout << char(FUGGOLEGES);
		std::cout << std::endl;
	}
}


void tablaInicializalasa(tabla& teglak)
{
	for (int i=0;i<JM;i++) for (int j=0;j<JM;j++) teglak.tegla[i][j]=' ';
	teglak.legfelsoSor=JM-1;
	teglak.utolsoSor=JM-1;
}

void teglaGeneralas(tabla& teglak)
{
	if (teglak.legfelsoSor == 0) teglak.legfelsoSor = JM - 1;
	else teglak.legfelsoSor--;
	for (int i = 0; i < JSZ; i++)
	{
		unsigned char T = rand() % 3 + 176;
		teglak.tegla[teglak.legfelsoSor][i] = T;
	}
}

int main()
{
	srand(time(NULL));
	tabla teglak;
	tablaInicializalasa(teglak);
	int agyu[3] = { 14,15,16 };
	char parancs = 0;
	bool valtozas = false;
	while (parancs != 27)
	{
		valtozas = false;
		parancs = jatekosIranyitasa(valtozas);
		//		if(valtozas) teglaGeneralas(teglak);
		agyuElhelyezese(agyu, parancs);
		kepernyoRajzolasa(teglak, agyu);
	}
	return 0;
}
